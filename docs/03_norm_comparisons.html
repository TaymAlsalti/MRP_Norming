<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2023-11-01" />

<title>MRP vs. Traditional Norming</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.28/datatables.js"></script>
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="01_data_cleaning.html">Data preprocessing</a>
</li>
<li>
  <a href="02_tutorial.html">Tutorial</a>
</li>
<li>
  <a href="03_norm_comparisons.html">Norm comparisons</a>
</li>
<li>
  <a href="04_supplements.html">Supplementary analyses</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/TaymAlsalti/MRP_Norming">
    <span class="fa fa-github"></span>
     
    
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">MRP vs. Traditional Norming</h1>
<h4 class="date">2023-11-01</h4>

</div>


<pre class="r"><code>knitr::opts_chunk$set(
    message = FALSE,
    warning = FALSE,
    include = TRUE,
    error = TRUE
)</code></pre>
<div id="load-dependencies-and-preprocessed-datasets"
class="section level1" number="1">
<h1><span class="header-section-number">1</span> Load dependencies and
preprocessed datasets</h1>
<pre class="r"><code>library(tidyverse)
library(ggrepel)
library(kableExtra)
library(brms)
library(tidybayes)
library(marginaleffects)
library(bayesplot)

load(&quot;../unshareable_data/preprocessed/tl.Rda&quot;)
load(&quot;../unshareable_data/preprocessed/manual_norms.Rda&quot;)
load(&quot;data/preprocessed/census.Rda&quot;)
sim_pop_sample_with_draws &lt;- readRDS(&quot;data/simulated/sim_pop_sample_with_draws.rds&quot;)



options(scipen = 999,
        digits = 4)

windowsFonts(Times = windowsFont(&quot;Times New Roman&quot;))
theme_set(theme_gray(base_size = 14, base_family = &quot;Times&quot;))

# exclude first twins to avoid twin dependency issues and add variable containing the age groups from the manual
tl_no_1st_twins &lt;- tl %&gt;% 
 filter(ptyp != 1) %&gt;% 
 mutate(age_group = case_when(
                         age0100 == 11 ~ &#39;11&#39;,
                         age0100 == 12 ~ &#39;12&#39;,
                         age0100 == 13 ~ &#39;13&#39;,
                         age0100 == 14 ~ &#39;14&#39;,
                         age0100 == 15 ~ &#39;15&#39;,
                         age0100 == 16 ~ &#39;16&#39;,
                         age &gt;= 17 &amp; age &lt;= 19 ~ &#39;17-19&#39;,
                         age &gt;= 20 &amp; age &lt;= 24 ~ &#39;20-24&#39;,
                         age &gt;= 25 &amp; age &lt;= 29 ~ &#39;25-29&#39;,
                         age &gt;= 30 &amp; age &lt;= 34 ~ &#39;30-34&#39;,
                         age &gt;= 35 &amp; age &lt;= 39 ~ &#39;35-39&#39;,
                         age &gt;= 40 &amp; age &lt;= 44 ~ &#39;40-44&#39;,
                         age &gt;= 45 &amp; age &lt;= 49 ~ &#39;45-49&#39;,
                         age &gt;= 50 &amp; age &lt;= 54 ~ &#39;50-54&#39;,
                         age &gt;= 55 &amp; age &lt;= 59 ~ &#39;55-59&#39;,
                         age &gt;= 60 &amp; age &lt;= 64 ~ &#39;60-64&#39;,
                         TRUE ~ NA_character_))</code></pre>
</div>
<div id="mrp-predictions-vs.-raw-means" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> MRP predictions vs. raw
means</h1>
<div id="average-difference-in-means" class="section level2"
number="2.1">
<h2><span class="header-section-number">2.1</span> Average difference in
means</h2>
<pre class="r"><code>means_sds_and_ses_MRP &lt;- sim_pop_sample_with_draws %&gt;%
  group_by(age, .draw) %&gt;% 
  summarise(mean_prediction = mean(.prediction), 
            sd_prediction = sd(.prediction)) %&gt;%
  group_by(age) %&gt;% 
  summarise(MRP_mean = mean(mean_prediction), 
            MRP_se_of_mean = sd(mean_prediction), 
            MRP_sd = sqrt(mean(sd_prediction^2)), 
            MRP_se_of_sd = sd(sd_prediction)) 


means_sds_and_ses_tl &lt;- tl_no_1st_twins %&gt;% 
  group_by(age0100) %&gt;% 
  summarise(Raw_n = n(), 
            Raw_mean = mean(cft, na.rm = T), 
            Raw_sd = sd(cft, na.rm = T), 
            Raw_se_of_mean = Raw_sd/sqrt(Raw_n)) %&gt;% 
  rename(age = age0100)


means_ns_sds_and_ses &lt;- census  %&gt;% 
  group_by(age) %&gt;% 
  filter(age &lt;= 65) %&gt;% 
  summarise (census_n = sum(census_n)) %&gt;% 
  left_join(means_sds_and_ses_MRP, by = c(&quot;age&quot;)) %&gt;% 
  left_join(means_sds_and_ses_tl, by = &quot;age&quot;) %&gt;% 
  mutate(abs_dif = abs(MRP_mean - Raw_mean))


t.test(means_ns_sds_and_ses$Raw_mean, means_ns_sds_and_ses$MRP_mean)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  means_ns_sds_and_ses$Raw_mean and means_ns_sds_and_ses$MRP_mean
## t = 2.4, df = 108, p-value = 0.02
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.2283 2.1839
## sample estimates:
## mean of x mean of y 
##     36.81     35.60</code></pre>
<p>On average a difference of ~ fifth of an SD between raw and corrected
means.</p>
</div>
<div id="browsable-table" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Browsable table</h2>
<p>Here you can browse both MRP and raw ns, means, SDs, and SEs.</p>
<pre class="r"><code>means_ns_sds_and_ses %&gt;% DT::datatable() %&gt;% DT::formatRound(columns = names(means_ns_sds_and_ses)[-c(1, 2, 7)], digits = 2)</code></pre>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ab365512eaaaa375dba6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab365512eaaaa375dba6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55"],[11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65],[769240,776800,795850,820090,777600,773860,794000,817120,834660,946570,969460,976760,988080,961910,931300,937720,938600,968250,965090,979500,947910,927650,923060,914650,882630,883050,912720,945270,1073280,1134230,1190090,1276570,1325360,1356430,1378520,1400540,1407870,1391410,1348090,1301320,1270990,1224990,1183220,1135550,1121210,1086770,1070850,1057980,1053560,1012340,1011600,943870,855750,834000,601800],[31.3349522123894,32.1593938294011,33.2740705679862,34.5823375694996,35.5476816292602,36.7150466101695,38.025546819788,38.8449732528041,38.3099337694195,38.8653783382789,38.9070775362319,38.4869365994236,38.3239377990431,38.0264141274238,37.9851732933233,37.8731474820144,37.5899059158945,37.5005335548173,37.4373113730929,37.3742082444918,37.0495116772824,37.4383992673993,37.089906025825,37.1130844155844,36.8156957831325,36.9027727632621,36.768,36.7682940766551,36.5131039794608,36.9811673517322,36.8665461756374,36.9279053562142,36.6478915906788,36.7282143950995,36.7239134092034,36.4173286544046,36.2299528255528,36.1130572002007,35.7684243926624,35.5879504800404,35.2466425485961,35.0153833883388,34.7584765760555,34.2974712441315,33.7795276442308,33.6570886075949,33.0072827918171,32.6043156862745,32.0322315457413,31.9171302356021,31.1463612637363,30.6180367700072,30.2784659182037,29.7948808971384,29.1819547413793],[0.364261437132174,0.330739279439417,0.321816365989755,0.302240877416298,0.328239944309936,0.34065677992547,0.331084993863289,0.35333878515453,0.867396811994393,0.492823197259443,0.367793553121667,0.317147792081611,0.29199235271525,0.283559160394864,0.288867944132433,0.296582554704766,0.29519471985434,0.300173681099755,0.307978942571795,0.297604917753704,0.312913039426371,0.298024654115966,0.289621945710566,0.290694326757458,0.278810421467359,0.281480504158627,0.269808492858147,0.260991659929406,0.252552423850705,0.248579304709364,0.232939646654007,0.226656663526795,0.225484370052572,0.232652613979114,0.218358908774072,0.223104892737814,0.221832087010038,0.222368836841418,0.221094160452076,0.224367885237721,0.233376689527179,0.244533305300698,0.255523944449339,0.262052531335672,0.279137465512527,0.30116311509636,0.315139708820944,0.346183462028767,0.376644699009379,0.40352147942453,0.45838993614274,0.494989738388335,0.595803431696527,0.650967105442562,0.762903720526423],[7.83380470935044,7.95288411038282,8.03468512653897,8.08086016021924,8.18976825888769,8.06320432675727,7.9807103620199,7.93301103122904,8.14910072656398,8.13194825404384,8.0527874298975,8.07488535882033,8.12537546688942,8.06706327009725,8.11785109039984,8.1089981889354,8.33218440744097,8.40330166792848,8.40668295700915,8.36291782424937,8.45774077736344,8.45438493620583,8.48698484847612,8.39624165586399,8.56586702042609,8.51487910265073,8.45082210484157,8.41672740923513,8.41848351608134,8.28617986422122,8.22601877033026,8.188608524444,8.23471570130471,8.14502801485856,8.19182236922382,8.15218047050651,8.1615604262715,8.09210215073895,8.06114222444106,8.01414632588073,8.07382811195787,8.06967769254623,8.07867890945681,8.11837885904417,8.19581646613701,8.07876743736395,8.18736198247191,8.16708145040938,8.17752598931742,8.24093416727965,8.32557585583462,8.26866141731926,8.32775643737494,8.32766929840385,8.43561015570806],[0.25607828858624,0.238529364976381,0.242762263238947,0.239060421761708,0.251425901002213,0.229540152938835,0.213719185724588,0.245559311225903,0.312827296011058,0.272081912643469,0.241609407713017,0.209845300314643,0.206361037041959,0.196235264670599,0.206075958072938,0.20002075190653,0.215127910286611,0.218929203511594,0.222629267615663,0.22648945882966,0.221099346468683,0.227263407363735,0.218301171927342,0.213324931005388,0.211215978439494,0.207736293807829,0.2006055458074,0.198070762464252,0.190264300175872,0.175445220514753,0.172558877643075,0.173616564060721,0.174988197864183,0.165864721001403,0.162047894567662,0.165887974534728,0.165101717067457,0.167812090634418,0.168491361349965,0.166795911890052,0.177077559060368,0.171261046641371,0.180094472264979,0.188525871487417,0.202376938300036,0.195402481354036,0.209991175115272,0.228881181317583,0.231106619833391,0.25892435926692,0.28600771952637,0.303643166743825,0.345258420460841,0.371747331921048,0.443156546406306],[908,110,141,130,89,122,965,120,86,73,61,285,458,257,70,48,34,26,29,24,60,73,92,128,143,157,169,190,195,203,228,224,237,300,337,298,300,311,314,324,291,262,238,206,169,118,113,79,66,53,32,34,17,18,13],[32.2577092511013,34.3272727272727,36.3049645390071,37.1461538461538,36.7078651685393,37.3196721311475,40.0766839378238,40.4666666666667,41.5581395348837,41.2328767123288,39,40.1263157894737,40.089519650655,39.9455252918288,39.2285714285714,38.375,36.5882352941176,34.8461538461538,37.3448275862069,32.5416666666667,36.1166666666667,37.5205479452055,38.0326086956522,36.75,38.5664335664336,37.1082802547771,37.1656804733728,37.4631578947368,37.9128205128205,38.0886699507389,38.1929824561403,38.2366071428571,37.4514767932489,37.8133333333333,38.4035608308605,38.0738255033557,38.2233333333333,37.7974276527331,37.8248407643312,37.2006172839506,36.5945017182131,37.2862595419847,36.5294117647059,37.1699029126214,35.5266272189349,35.4152542372881,35.1769911504425,35.5822784810127,34.2575757575758,33.9622641509434,34.71875,31.6764705882353,28.9411764705882,30.9444444444444,31.0769230769231],[7.32981827752394,7.33235770799304,8.07637052713598,8.27540630020739,8.01731400157158,8.49040916714253,7.43480135242369,7.45849392656863,7.1448947650634,7.5415894065015,8.19959348585851,7.5052687201657,7.38964466983631,8.08384706772691,8.44791618002209,9.77540334913593,9.03232460114974,10.5629250028287,7.04716691843997,8.67770339616906,9.2792673342181,7.69579536904748,9.15009288003844,8.31183578839406,7.39866702931659,8.30398392017921,8.34642814491609,7.76072124275454,8.62970115378863,8.37086056735226,8.00757041912914,8.27781621876794,8.00018325614323,8.2526060881625,7.87308474952627,8.0992113842577,7.90072954310337,7.67615451905407,7.92846738168773,7.8056817990763,7.35788369188267,7.64728447893293,7.31604044232842,7.3501463061789,7.64857992480692,7.9843075484871,8.69136485305096,7.89450895654972,8.1680627701585,9.56347672568552,7.91174861386737,7.68990124157452,7.76587558034584,8.72772608497649,8.31125279828036],[0.24324856302921,0.699112876553792,0.680153095467258,0.725801145862081,0.849833584501118,0.768685528153487,0.239334723765694,0.680864228099486,0.770453816763516,0.882676275819122,1.04985036664742,0.444573750367057,0.345295419200156,0.504256525625386,1.00971911076213,1.4109579387652,1.54903088964506,2.07156002730926,1.30862604410984,1.77132878831924,1.19794826168111,0.900724718579986,0.953963127724514,0.734669431260309,0.618707618796889,0.662730065552505,0.642032934224314,0.563021894534267,0.617985735474329,0.587519234096858,0.530314306080672,0.553084860737682,0.51966774573498,0.476464434651656,0.428874254337216,0.469174718271061,0.456148832850516,0.435274789211888,0.447429299195548,0.433648988837572,0.431326780796826,0.472450812907846,0.474228465637551,0.512108959138843,0.588352301908225,0.735015087063121,0.817614829200078,0.888201651076623,1.00541902479159,1.31364455635032,1.39861277397722,1.31880718281565,1.88350148783357,2.05714476634187,2.3051267790418],[0.922757038711943,2.16787889787164,3.03089397102087,2.56381627665424,1.16018353927915,0.604625520978047,2.05113711803585,1.62169341386253,3.24820576546426,2.36749837404984,0.0929224637681187,1.63937919005006,1.76558185161196,1.91911116440497,1.2433981352481,0.501852517985611,1.00167062177687,2.65437970866343,0.092483786886028,4.83254157782516,0.932845010615708,0.0821486778062095,0.942702669827206,0.363084415584417,1.75073778330103,0.205507491515,0.39768047337278,0.694863818081792,1.39971653335967,1.10750259900668,1.32643628050295,1.3087017866429,0.803585202570119,1.08511893823379,1.67964742165717,1.65649684895106,1.99338050778051,1.68437045253242,2.05641637166885,1.61266680391019,1.34785916961695,2.2708761536459,1.77093518865036,2.8724316684899,1.74709957470414,1.7581656296932,2.16970835862539,2.97796279473815,2.22534421183443,2.0451339153413,3.57238873626374,1.05843381822809,1.33728944761545,1.14956354730601,1.89496833554377]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>census_n<\/th>\n      <th>MRP_mean<\/th>\n      <th>MRP_se_of_mean<\/th>\n      <th>MRP_sd<\/th>\n      <th>MRP_se_of_sd<\/th>\n      <th>Raw_n<\/th>\n      <th>Raw_mean<\/th>\n      <th>Raw_sd<\/th>\n      <th>Raw_se_of_mean<\/th>\n      <th>abs_dif<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render"],"jsHooks":[]}</script>
</div>
<div id="plot-of-means-95-cis" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Plot of means + 95%
CIs</h2>
<pre class="r"><code>means_ns_sds_and_ses %&gt;%
  pivot_longer(-age, names_to = c(&quot;source&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;%
  filter(source != &quot;census&quot; &amp; source != &quot;abs&quot;) %&gt;%
  ggplot(aes(x = as.factor(age), y = mean, group = source, colour = source)) +
  geom_line(linewidth = 1) +
  geom_pointrange(shape = 18, 
                  aes(ymin = mean - 1.96*se_of_mean, ymax = mean + 1.96*se_of_mean), 
                  fatten = 6,
                  linewidth = 1.5,
                  position = position_dodge(width = 0.3)) +
  geom_label_repel(
    data = means_ns_sds_and_ses %&gt;% filter(age &lt;= 65) %&gt;% pivot_longer(-age, names_to = c(&quot;source&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(source != &quot;census&quot; &amp; source != &quot;abs&quot;) %&gt;% group_by(source) %&gt;% filter(age == 11),
    aes(label = source, x = as.factor(age), y = mean, color = source), family = &quot;Times&quot;, seed = 810) +
  scale_x_discrete(breaks = seq(12, 79, by = 2)) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_line(color = &quot;gray&quot;, linetype = &quot;dashed&quot;),
    panel.grid.minor.x = element_blank(),
    text = element_text(family = &quot;Times&quot;),
    legend.position = &quot;none&quot;
  ) +
  scale_colour_manual(values = c(&quot;#0072b2&quot;, &quot;#e69f00&quot;)) +
  labs(x = &quot;Age&quot;, y = &quot;Mean CFT 20-R Score&quot;)</code></pre>
<p><img src="03_norm_comparisons_files/figure-html/unnamed-chunk-4-1.png" width="864" /></p>
</div>
<div id="plot-of-sds" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Plot of SDs</h2>
<pre class="r"><code>means_ns_sds_and_ses %&gt;%
  filter(age &lt;= 65) %&gt;%
  pivot_longer(-age, names_to = c(&quot;source&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;%
  filter(source != &quot;census&quot; &amp; source != &quot;abs&quot;) %&gt;%
  ggplot(aes(x = as.factor(age), y = sd, group = source, colour = source)) +
  geom_line(linewidth = 1) +
  geom_pointrange(shape = 18, 
                  aes(ymin = sd - 1.96*se_of_sd, ymax = sd + 1.96*se_of_sd), 
                  fatten = 6,
                  linewidth = 1.5,
                  position = position_dodge(width = 0.3)) +
  geom_label_repel(
    data = means_ns_sds_and_ses %&gt;% filter(age &lt;= 65) %&gt;% pivot_longer(-age, names_to = c(&quot;source&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(source != &quot;census&quot; &amp; source != &quot;abs&quot;) %&gt;% group_by(source) %&gt;% filter(age == 11),
    aes(label = source, x = as.factor(age), y = sd, color = source), family = &quot;Times&quot;, seed = 810) +
  scale_x_discrete(breaks = seq(12, 79, by = 2)) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_line(color = &quot;gray&quot;, linetype = &quot;dashed&quot;),
    panel.grid.minor.x = element_blank(),
    text = element_text(family = &quot;Times&quot;),
    legend.position = &quot;none&quot;
  ) +
  scale_colour_manual(values = c(&quot;#0072b2&quot;, &quot;#e69f00&quot;)) +
  labs(x = &quot;Age&quot;, y = &quot;CFT 20-R Score SD&quot;)</code></pre>
<p><img src="03_norm_comparisons_files/figure-html/unnamed-chunk-5-1.png" width="864" /></p>
</div>
</div>
<div id="mrp-norms-vs.-manual-norms-vs.-raw-means"
class="section level1" number="3">
<h1><span class="header-section-number">3</span> MRP norms vs. manual
norms vs. raw means</h1>
<p>Here we compare the MRP-based norms to the traditionally constructed
norms reported in the CFT 20-R manual. We aggregate by the age groups as
reported in the manual normal tables. Note that the manual means and SDs
for ages 20 and older are based on the very same TwinLife sample we are
using, they just use a different correction method that isn’t described
in enough detail to make it reproducible for us.</p>
<div id="plots-of-means-and-sds" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Plots of means and
SDs</h2>
<pre class="r"><code>means_sds_and_ses_MRP &lt;- sim_pop_sample_with_draws  %&gt;% # the same one from above
  mutate(age_group = case_when(
                         age == 11 ~ &#39;11&#39;,
                         age == 12 ~ &#39;12&#39;,
                         age == 13 ~ &#39;13&#39;,
                         age == 14 ~ &#39;14&#39;,
                         age == 15 ~ &#39;15&#39;,
                         age == 16 ~ &#39;16&#39;,
                         age &gt;= 17 &amp; age &lt;= 19 ~ &#39;17-19&#39;,
                         age &gt;= 20 &amp; age &lt;= 24 ~ &#39;20-24&#39;,
                         age &gt;= 25 &amp; age &lt;= 29 ~ &#39;25-29&#39;,
                         age &gt;= 30 &amp; age &lt;= 34 ~ &#39;30-34&#39;,
                         age &gt;= 35 &amp; age &lt;= 39 ~ &#39;35-39&#39;,
                         age &gt;= 40 &amp; age &lt;= 44 ~ &#39;40-44&#39;,
                         age &gt;= 45 &amp; age &lt;= 49 ~ &#39;45-49&#39;,
                         age &gt;= 50 &amp; age &lt;= 54 ~ &#39;50-54&#39;,
                         age &gt;= 55 &amp; age &lt;= 59 ~ &#39;55-59&#39;,
                         age &gt;= 60 &amp; age &lt;= 64 ~ &#39;60-64&#39;,
                         TRUE ~ NA_character_)) %&gt;% 
  group_by(age_group, .draw) %&gt;%
    summarise(mean_prediction = mean(.prediction), sd_prediction = sd(.prediction)) %&gt;%
    summarise(MRP_mean = mean(mean_prediction),
              MRP_se_of_mean = sd(mean_prediction),
              MRP_sd = sqrt(mean(sd_prediction^2)),
              MRP_se_of_sd = sd(sd_prediction)) %&gt;% 
  filter(!is.na(age_group))


means_sds_and_ses_tl &lt;- tl_no_1st_twins %&gt;% 
  filter(!is.na(age_group)) %&gt;%
  group_by(age_group) %&gt;% 
  summarise(Raw_n = n(), 
            Raw_mean = mean(cft, na.rm = T), 
            Raw_sd = sd(cft, na.rm = T), 
            Raw_se_of_mean = Raw_sd/sqrt(Raw_n)) 



means_sds_and_ses &lt;- means_sds_and_ses_MRP %&gt;%
  left_join(means_sds_and_ses_tl, by = &quot;age_group&quot;) %&gt;% 
  left_join(manual_norms, by = &quot;age_group&quot;)



# means and CIs
means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% 
  filter(provenance != &quot;census&quot; 
         ) %&gt;%
  ggplot(aes(x = age_group, y = mean, group = provenance, colour = provenance)) +
  geom_line(linewidth = 1) +
  geom_pointrange(shape = 18, 
                  aes(ymin = mean - 1.96*se_of_mean, ymax = mean + 1.96*se_of_mean), 
                  fatten = 6,
                  linewidth = 1.5,
                  position = position_dodge(width = 0.3))  +
  scale_colour_manual(values = c(&quot;#009e73&quot;, &quot;#0072b2&quot;, &quot;#e69f00&quot;)) +
  labs(x = &quot;Age Group&quot;, y = &quot;Mean CFT 20-R Score&quot;) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;11&quot;),
    aes(label = c(&quot;MRP&quot;, &quot;Raw&quot;, &quot;&quot;), x = age_group, y = mean, color = provenance), family = &quot;Times&quot;, seed = 810) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;14&quot;),
    aes(label = c(&quot;&quot;, &quot;&quot;, &quot;Manual, school sample&quot;), x = age_group, y = mean, color = provenance), family = &quot;Times&quot;, seed = 810, nudge_y = 2.5) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;40-44&quot;),
    aes(label = c(&quot;&quot;, &quot;&quot;, &quot;Manual, TwinLife sample&quot;), x = age_group, y = mean, color = provenance), family = &quot;Times&quot;, seed = 810, nudge_y = -2.5) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_line(color = &quot;gray&quot;, linetype = &quot;dashed&quot;),
    panel.grid.minor.x = element_blank(),
    text = element_text(family = &quot;Times&quot;),
    legend.position = &quot;none&quot;
  ) + 
  geom_vline(xintercept = 7.5)</code></pre>
<p><img src="03_norm_comparisons_files/figure-html/unnamed-chunk-6-1.png" width="864" /></p>
<pre class="r"><code># SDs
means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% 
  filter(provenance != &quot;census&quot; 
         )   %&gt;%
  ggplot(aes(x = age_group, y = sd, group = provenance, colour = provenance)) +
  geom_line(linewidth = 1) +
  geom_pointrange(shape = 18, 
                  aes(ymin = sd - 1.96*se_of_sd, ymax = sd + 1.96*se_of_sd), 
                  fatten = 6,
                  linewidth = 1.5,
                  position = position_dodge(width = 0.3))  +
  scale_colour_manual(values = c(&quot;#009e73&quot;, &quot;#0072b2&quot;, &quot;#e69f00&quot;)) +
  labs(x = &quot;Age Group&quot;, y = &quot;CFT 20-R Score SD&quot;) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;11&quot;),
    aes(label = c(&quot;MRP&quot;, &quot;Raw&quot;, &quot;&quot;), x = age_group, y = sd, color = provenance), family = &quot;Times&quot;, seed = 810) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;14&quot;),
    aes(label = c(&quot;&quot;, &quot;&quot;, &quot;Manual, school sample&quot;), x = age_group, y = sd, color = provenance), family = &quot;Times&quot;, seed = 810, nudge_y = -.5) +
  geom_label_repel(
    data = means_sds_and_ses %&gt;% 
  pivot_longer(-age_group, names_to = c(&quot;provenance&quot;, &quot;.value&quot;), names_pattern = &quot;([^_]*)_(.*)&quot;) %&gt;% filter(age_group == &quot;40-44&quot;),
    aes(label = c(&quot;&quot;, &quot;&quot;, &quot;Manual, TwinLife sample&quot;), x = age_group, y = sd, color = provenance), family = &quot;Times&quot;, seed = 810, nudge_y = .5) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_line(color = &quot;gray&quot;, linetype = &quot;dashed&quot;),
    panel.grid.minor.x = element_blank(),
    text = element_text(family = &quot;Times&quot;),
    legend.position = &quot;none&quot;
  ) + 
  geom_vline(xintercept = 7.5)</code></pre>
<p><img src="03_norm_comparisons_files/figure-html/unnamed-chunk-7-1.png" width="864" /></p>
</div>
<div id="iq-calculations" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> IQ calculations</h2>
<p>Rather than calculating IQs for all possible CFT 20-R scores (0-56),
we restrict our calculations to those which occur in our data.</p>
<div id="linearly-transformed-iqs" class="section level3"
number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Linearly
transformed IQs</h3>
<pre class="r"><code>iq &lt;- function(cft_score, mean, sd) {
  iq_score &lt;- ((cft_score - mean) / sd) * 15 + 100
  return(iq_score)
}


iqs_linear &lt;- tl_no_1st_twins %&gt;% 
  filter(!is.na(age_group)) %&gt;% 
  group_by(age_group, cft) %&gt;% 
  summarise(n()) %&gt;% 
  select(age_group, cft) %&gt;% 
  left_join(select(means_sds_and_ses, c(Manual_mean, MRP_mean, Manual_sd, MRP_sd, age_group)), by = &quot;age_group&quot;) %&gt;% 
  mutate(MRP_IQ_linear = round(iq(cft, MRP_mean, MRP_sd)),
         Manual_IQ_linear = round(iq(cft, Manual_mean, Manual_sd)),
         IQ_linear_dif = MRP_IQ_linear - Manual_IQ_linear,
         IQ_linear_dif_abs = abs(MRP_IQ_linear - Manual_IQ_linear))</code></pre>
</div>
<div id="normalised-area-transformed-normal-rank-transformed-iqs"
class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Normalised (area
transformed / normal rank transformed) IQs</h3>
<pre class="r"><code>iqs_normalised &lt;- sim_pop_sample_with_draws %&gt;% 
  mutate(raw_score = round(.prediction),
         age_group = case_when(
                         age == 11 ~ &#39;11&#39;,
                         age == 12 ~ &#39;12&#39;,
                         age == 13 ~ &#39;13&#39;,
                         age == 14 ~ &#39;14&#39;,
                         age == 15 ~ &#39;15&#39;,
                         age == 16 ~ &#39;16&#39;,
                         age &gt;= 17 &amp; age &lt;= 19 ~ &#39;17-19&#39;,
                         age &gt;= 20 &amp; age &lt;= 24 ~ &#39;20-24&#39;,
                         age &gt;= 25 &amp; age &lt;= 29 ~ &#39;25-29&#39;,
                         age &gt;= 30 &amp; age &lt;= 34 ~ &#39;30-34&#39;,
                         age &gt;= 35 &amp; age &lt;= 39 ~ &#39;35-39&#39;,
                         age &gt;= 40 &amp; age &lt;= 44 ~ &#39;40-44&#39;,
                         age &gt;= 45 &amp; age &lt;= 49 ~ &#39;45-49&#39;,
                         age &gt;= 50 &amp; age &lt;= 54 ~ &#39;50-54&#39;,
                         age &gt;= 55 &amp; age &lt;= 59 ~ &#39;55-59&#39;,
                         age &gt;= 60 &amp; age &lt;= 64 ~ &#39;60-64&#39;,
                         TRUE ~ NA_character_)) %&gt;% 
  filter(!is.na(age_group)) %&gt;% 
  group_by(age_group, .draw) %&gt;% 
  mutate(percentile = ecdf(raw_score)(raw_score)) %&gt;%
  mutate(iq_score_tr_ag = qnorm(percentile) * 15 + 100) %&gt;% 
  group_by(age_group, raw_score) %&gt;% 
  summarise(percentile = mean(percentile),
            iq_score_tr_ag = mean(iq_score_tr_ag)) %&gt;% 
  mutate(iq_score_tr_ag = ifelse(is.finite(iq_score_tr_ag), iq_score_tr_ag, NA),
         iq_score_ag_tr = qnorm(percentile) * 15 + 100,
         MRP_IQ_normalised = round(coalesce(iq_score_tr_ag, iq_score_ag_tr))) %&gt;% 
  select(age_group, raw_score, MRP_IQ_normalised) %&gt;% 
  rename(&quot;cft&quot; = raw_score)</code></pre>
</div>
<div id="some-aggregated-comparisons-between-mrp-and-manual-iqs"
class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Some aggregated
comparisons between MRP and Manual IQs</h3>
<pre class="r"><code>iq_table &lt;- iqs_linear %&gt;% 
  left_join(iqs_normalised, by = c(&quot;age_group&quot;, &quot;cft&quot;)) %&gt;% 
  mutate(IQ_MRP_abs_dif = abs(MRP_IQ_linear - MRP_IQ_normalised),
         Manual_kids_sample = ifelse(age_group %in% c(&quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17-19&quot;), TRUE, FALSE)) %&gt;%
  arrange(-IQ_linear_dif_abs)


mean(iq_table$IQ_linear_dif_abs)</code></pre>
<pre><code>## [1] 4.445</code></pre>
<pre class="r"><code>mean(iq_table$IQ_MRP_abs_dif)</code></pre>
<pre><code>## [1] 1.506</code></pre>
<pre class="r"><code>iq_table %&gt;% group_by(Manual_kids_sample) %&gt;% summarise(mean(IQ_linear_dif_abs))</code></pre>
<pre><code>## # A tibble: 2 × 2
##   Manual_kids_sample `mean(IQ_linear_dif_abs)`
##   &lt;lgl&gt;                                  &lt;dbl&gt;
## 1 FALSE                                   2.21
## 2 TRUE                                    7.76</code></pre>
</div>
</div>
</div>
<div id="session-info" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Session info</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.3.0 (2023-04-21 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19045)
## 
## Matrix products: default
## 
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.utf8 
## [2] LC_CTYPE=English_United Kingdom.utf8   
## [3] LC_MONETARY=English_United Kingdom.utf8
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.utf8    
## 
## time zone: Europe/Berlin
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
##  [1] bayesplot_1.10.0       marginaleffects_0.12.0 tidybayes_3.0.4       
##  [4] brms_2.20.4            Rcpp_1.0.10            kableExtra_1.3.4      
##  [7] ggrepel_0.9.3          forcats_0.5.2          stringr_1.5.0         
## [10] dplyr_1.1.2            purrr_1.0.1            readr_2.1.3           
## [13] tidyr_1.2.1            tibble_3.2.1           ggplot2_3.4.2         
## [16] tidyverse_1.3.2       
## 
## loaded via a namespace (and not attached):
##   [1] tensorA_0.36.2       rstudioapi_0.14      jsonlite_1.8.4      
##   [4] magrittr_2.0.3       estimability_1.4.1   farver_2.1.1        
##   [7] rmarkdown_2.21       fs_1.6.2             vctrs_0.6.2         
##  [10] base64enc_0.1-3      webshot_0.5.4        htmltools_0.5.5     
##  [13] distributional_0.3.2 curl_5.0.0           haven_2.5.1         
##  [16] broom_1.0.4          cellranger_1.1.0     googlesheets4_1.0.1 
##  [19] sass_0.4.6           StanHeaders_2.26.26  bslib_0.4.2         
##  [22] htmlwidgets_1.6.2    plyr_1.8.8           emmeans_1.8.7       
##  [25] zoo_1.8-12           lubridate_1.9.0      cachem_1.0.8        
##  [28] igraph_1.4.2         mime_0.12            lifecycle_1.0.3     
##  [31] pkgconfig_2.0.3      colourpicker_1.2.0   Matrix_1.5-4        
##  [34] R6_2.5.1             fastmap_1.1.1        shiny_1.7.4         
##  [37] digest_0.6.31        colorspace_2.1-0     ps_1.7.5            
##  [40] crosstalk_1.2.0      labeling_0.4.2       fansi_1.0.4         
##  [43] timechange_0.2.0     httr_1.4.5           abind_1.4-5         
##  [46] compiler_4.3.0       gargle_1.4.0         withr_2.5.0         
##  [49] backports_1.4.1      inline_0.3.19        shinystan_2.6.0     
##  [52] DBI_1.1.3            highr_0.10           pkgbuild_1.4.0      
##  [55] gtools_3.9.4         loo_2.6.0            tools_4.3.0         
##  [58] googledrive_2.0.0    httpuv_1.6.11        threejs_0.3.3       
##  [61] glue_1.6.2           callr_3.7.3          nlme_3.1-162        
##  [64] promises_1.2.0.1     grid_4.3.0           checkmate_2.2.0     
##  [67] reshape2_1.4.4       generics_0.1.3       gtable_0.3.3        
##  [70] tzdb_0.3.0           data.table_1.14.6    hms_1.1.2           
##  [73] xml2_1.3.3           utf8_1.2.3           ggdist_3.2.1        
##  [76] pillar_1.9.0         markdown_1.6         posterior_1.4.1     
##  [79] later_1.3.1          lattice_0.20-45      renv_0.17.3         
##  [82] tidyselect_1.2.0     miniUI_0.1.1.1       knitr_1.42          
##  [85] arrayhelpers_1.1-0   gridExtra_2.3        V8_4.3.0            
##  [88] svglite_2.1.1        stats4_4.3.0         xfun_0.39           
##  [91] bridgesampling_1.1-2 matrixStats_0.63.0   DT_0.28             
##  [94] rstan_2.26.22        stringi_1.7.12       yaml_2.3.7          
##  [97] evaluate_0.21        codetools_0.2-19     cli_3.6.1           
## [100] RcppParallel_5.1.7   shinythemes_1.2.0    xtable_1.8-4        
## [103] systemfonts_1.0.4    munsell_0.5.0        processx_3.8.2      
## [106] jquerylib_0.1.4      modelr_0.1.11        readxl_1.4.1        
## [109] dbplyr_2.3.0         coda_0.19-4          svUnit_1.0.6        
## [112] parallel_4.3.0       rstantools_2.3.1     ellipsis_0.3.2      
## [115] assertthat_0.2.1     prettyunits_1.1.1    dygraphs_1.1.1.6    
## [118] reprex_2.0.2         Brobdingnag_1.2-9    viridisLite_0.4.2   
## [121] mvtnorm_1.1-3        scales_1.2.1         xts_0.13.1          
## [124] crayon_1.5.2         rlang_1.1.1          rvest_1.0.3         
## [127] shinyjs_2.1.0</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
